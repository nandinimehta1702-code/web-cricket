<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cricket Arcade</title>

  <!-- Phaser -->
  <script src="https://cdn.jsdelivr.net/npm/phaser@3.70.0/dist/phaser.min.js"></script>

  <style>
    :root { --ink:#e6edf6; --bg:#0b1220; --panel:#0f172a; --line:#334155; --muted:#9aa4b2; --accent:#8ae89a; }
    html,body { height:100%; margin:0; background:var(--bg); color:var(--ink); font-family:system-ui, Segoe UI, Inter, Roboto, sans-serif;}
    .wrap { max-width:1000px; margin:0 auto; padding:16px; }
    #hud { font-size:14px; margin-bottom:10px }
    #hud b { color:var(--accent) }
    #stage { position:relative; display:flex; justify-content:center; }
    #game { width:800px; height:450px; background:var(--bg); border-radius:12px; overflow:hidden }
    #help { text-align:center; font-size:12px; color:var(--muted); margin:8px 0 0 }
    #comms { margin-top:14px; background:var(--panel); border:1px solid #1f2937; border-radius:14px; padding:14px; min-height:72px; }
    #comms h3 { margin:0 0 8px; font-size:14px; color:#cbd5e1 }
    #feed { font-size:14px; line-height:1.35 }
    #feed .dim { color:var(--muted) }

    .toolbar { display:flex; gap:10px; margin-bottom:10px; align-items:center; }
    .select, .btn { background:#111827; border:1px solid #293241; color:var(--ink); border-radius:10px; padding:8px 10px; }
    .btn { cursor:pointer; }
    .btn:disabled { opacity:.5; cursor:not-allowed }

    /* mobile buttons */
    .mobile-keys { position:absolute; bottom:10px; right:10px; display:flex; gap:8px; }
    .mkey { background:#111827; border:1px solid #293241; border-radius:10px; padding:8px 12px; color:var(--ink); }

    /* avatar modal */
    #charpick { position:fixed; inset:0; background:#0009; display:none; align-items:center; justify-content:center; z-index:10 }
    #charbox { background:var(--panel); border:1px solid #1f2937; border-radius:16px; padding:18px 22px; min-width:280px; text-align:center }
    #charbox h3 { margin:0 0 12px }
    .row { display:flex; gap:10px; justify-content:center }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="toolbar">
      <select id="overs" class="select">
        <option value="2" selected>2 overs</option>
        <option value="3">3 overs</option>
        <option value="5">5 overs</option>
      </select>
      <button id="newBtn" class="btn">New Game</button>
      <button id="pickBtn" class="btn">Choose Player</button>
    </div>

    <div id="hud"><b>Score:</b> 0/0 • <b>Overs:</b> 0.0 • <b>Balls left:</b> 12</div>

    <div id="stage">
      <div id="game"></div>
      <div class="mobile-keys">
        <button class="mkey" id="leftBtn">◀</button>
        <button class="mkey" id="hitBtn">HIT</button>
        <button class="mkey" id="rightBtn">▶</button>
      </div>
    </div>

    <div id="help">← / → (or A / D) to move • SPACE to swing</div>

    <div id="comms">
      <h3>Commentary</h3>
      <div id="feed"><span class="dim">No balls bowled yet. Play a shot!</span></div>
    </div>
  </div>

  <!-- Avatar picker -->
  <div id="charpick">
    <div id="charbox">
      <h3>Choose your player</h3>
      <div class="row">
        <button id="pickBoy" class="btn">Boy</button>
        <button id="pickGirl" class="btn">Girl</button>
      </div>
    </div>
  </div>

  <script>
    // show picker if not set
    const picker = document.getElementById('charpick');
    const saved = localStorage.getItem('avatar');
    if (!saved) picker.style.display = 'flex';
    document.getElementById('pickBtn').onclick = () => { picker.style.display = 'flex'; };
    document.getElementById('pickBoy').onclick  = () => { localStorage.setItem('avatar','boy');  picker.style.display='none'; window.Game?.reload(); };
    document.getElementById('pickGirl').onclick = () => { localStorage.setItem('avatar','girl'); picker.style.display='none'; window.Game?.reload(); };

    // boot game
    document.getElementById('newBtn').onclick = () => window.Game?.newMatch();
  </script>

  <!-- the actual game -->
  <script src="/static/game/game.js"></script>
</body>
</html>
